import java.nio.charset.Charset;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.HashMap;
import java.util.Map;
import java.util.Set;
import java.util.Map.Entry;


public class QuerySPARQL {

	public static void main(String[] args) {
		Map<String, CountObject> results = new HashMap<String, CountObject>();
		Map<String, InstanceObject> resultsInstance = new HashMap<String, InstanceObject>();
		int endpoint = 0;
		
		// query DBpedia
		//QueryObject dbpedia = new QueryObject();
		//results = dbpedia.queryEndpoint(endpoint);
		//printCountHeader();
		//printResults(results);
				
		
		// query YAGO
		endpoint = 1;
		QueryObject yago = new QueryObject();
		resultsInstance = yago.queryEndpoint(endpoint);
		//printCountHeader();
		//printResults(resultsInstance);
		writeResultsToFile(resultsInstance);
		
		
		// query Wikidata
		//QueryWikidataObject wiki = new QueryWikidataObject();
		//wiki.queryEndpoint();
		 	
		
	
	}
	private static void writeResultsToFile(
			Map<String, InstanceObject> resultsInstance) {
		//write to file
		//http://stackoverflow.com/questions/2885173/how-to-create-a-file-and-write-to-a-file-in-java
		//for (Entry<String, Set<String>> entry : classInstances.entrySet()) {
		for (Entry<String, Set<String>> entry : classInstancesWithLabel.entrySet()) {
			//write instances to disk
			Path fileName = Paths.get("yagoResults/" + getClassNameOfURI(entry.getKey()) + "InstancesWithLabels.txt");		
			Files.write(fileName, entry.getValue(), Charset.forName("UTF-8"));
			
		}
		
	}
	private static void printResults(Map<String, CountObject> results) {
		for (Map.Entry<String, CountObject> entry : results.entrySet()) {
		    results.get(entry.getKey()).printAll();
		}
	}
	private static void printResultsInstance(Map<String, InstanceObject> results) {
		for (Map.Entry<String, InstanceObject> entry : results.entrySet()) {
		    results.get(entry.getKey()).printAll();
		}
	}
	public static void printCountHeader() {
		System.out.println("className, count, classIndegree, classOutdegree, "
				+ "classInstanceIndegreeMin, classInstanceIndegreeAvg, classInstanceIndegreeMed, classInstanceIndegreeMax, "
				+ "classInstanceOutdegreeMin, classInstanceOutdegreeAvg, classInstanceOutdegreeMed, classInstanceOutdegreeMax");
	}


}
